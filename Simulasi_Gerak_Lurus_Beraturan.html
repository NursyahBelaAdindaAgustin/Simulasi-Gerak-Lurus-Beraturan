<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Simulasi Gerak Lurus Beraturan (Mobil Maju Lancar)</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: "Poppins", sans-serif;
      background: #eef2f3;
      text-align: center;
      margin: 0;
      padding: 20px;
    }

    h1 { color: #333; }

    .kontrol {
      margin-bottom: 15px;
    }

    input {
      width: 90px;
      text-align: center;
      margin: 5px;
      padding: 3px;
    }

    #simulasi {
      position: relative;
      width: 90%;
      height: 200px;
      margin: 20px auto;
      background: linear-gradient(to top, #a8d5e2 70%, #e0f7fa 30%);
      border: 2px solid #333;
      border-radius: 10px;
      overflow: hidden;
    }

    #mobil {
      position: absolute;
      bottom: 50px;
      left: 0;
      font-size: 50px;
      transform: scaleX(-1); /* menghadap kanan */
    }

    #koordinat {
      position: absolute;
      bottom: 15px;
      left: 10px;
      font-size: 16px;
      background: rgba(255,255,255,0.8);
      padding: 3px 8px;
      border-radius: 6px;
      font-weight: 500;
    }

    table {
      margin: 20px auto;
      border-collapse: collapse;
      width: 60%;
      background: white;
    }

    table, th, td {
      border: 1px solid #888;
    }

    th, td {
      padding: 6px;
      text-align: center;
    }

    canvas {
      width: 90%;
      max-width: 700px;
      margin-top: 20px;
    }

    button {
      padding: 8px 16px;
      margin: 5px;
      border: none;
      background-color: #0288d1;
      color: white;
      border-radius: 8px;
      cursor: pointer;
    }

    button:hover { background-color: #01579b; }
  </style>
</head>
<body>

  <h1>Simulasi Gerak Lurus Beraturan (GLB)</h1>

  <div class="kontrol">
    <label>Posisi awal (m):</label>
    <input type="number" id="posisiAwal" value="0">
    <label>Kecepatan (m/s):</label>
    <input type="number" id="kecepatan" value="3" step="0.5">
    <button onclick="mulai()">Mulai</button>
    <button id="berhenti">Berhenti</button>
    <button onclick="resetSimulasi()">Reset</button>
  </div>

  <div id="simulasi">
    <div id="mobil">üèéÔ∏è</div>
    <div id="koordinat">(0 m, 0 s)</div>
  </div>

  <h3>Tabel Pengamatan</h3>
  <table id="tabelData">
    <tr>
      <th>Waktu (s)</th>
      <th>Posisi (m)</th>
      <th>Kecepatan (m/s)</th>
    </tr>
  </table>

  <h3>Grafik Posisi - Waktu</h3>
  <canvas id="grafikPosisi"></canvas>

  <h3>Grafik Kecepatan - Waktu</h3>
  <canvas id="grafikKecepatan"></canvas>

  <script>
    let waktu = 0;
    let posisi = 0;
    let kecepatan = 0;
    let animasi;
    let waktuMulai;
    let jalan = false;

    const mobil = document.getElementById("mobil");
    const koordinat = document.getElementById("koordinat");
    const tabel = document.getElementById("tabelData");
    const ctxPosisi = document.getElementById("grafikPosisi").getContext("2d");
    const ctxKecepatan = document.getElementById("grafikKecepatan").getContext("2d");

    const chartPosisi = new Chart(ctxPosisi, {
      type: "line",
      data: {
        labels: [],
        datasets: [{
          label: "Posisi (m)",
          data: [],
          borderColor: "blue",
          fill: false,
          tension: 0
        }]
      }
    });

    const chartKecepatan = new Chart(ctxKecepatan, {
      type: "line",
      data: {
        labels: [],
        datasets: [{
          label: "Kecepatan (m/s)",
          data: [],
          borderColor: "red",
          fill: false,
          tension: 0
        }]
      }
    });

    function mulai() {
      resetSimulasi(false);
      posisi = parseFloat(document.getElementById("posisiAwal").value);
      kecepatan = parseFloat(document.getElementById("kecepatan").value);
      waktuMulai = performance.now();
      jalan = true;
      requestAnimationFrame(updateSimulasi);
    }

    function updateSimulasi(timestamp) {
      if (!jalan) return;
      const deltaWaktu = (timestamp - waktuMulai) / 1000;
      waktu = deltaWaktu.toFixed(2);
      posisi = parseFloat(document.getElementById("posisiAwal").value) + kecepatan * deltaWaktu;

      const xPixel = posisi * 10;
      mobil.style.left = xPixel + "px";
      koordinat.innerHTML = `(${posisi.toFixed(2)} m, ${waktu}s)`;
      koordinat.style.left = (xPixel + 10) + "px";

      // Update setiap detik ke tabel dan grafik
      if (Math.abs(deltaWaktu - Math.round(deltaWaktu)) < 0.02) {
        const row = tabel.insertRow();
        row.insertCell(0).innerHTML = Math.round(deltaWaktu);
        row.insertCell(1).innerHTML = posisi.toFixed(2);
        row.insertCell(2).innerHTML = kecepatan.toFixed(2);

        chartPosisi.data.labels.push(Math.round(deltaWaktu));
        chartPosisi.data.datasets[0].data.push(posisi);
        chartPosisi.update();

        chartKecepatan.data.labels.push(Math.round(deltaWaktu));
        chartKecepatan.data.datasets[0].data.push(kecepatan);
        chartKecepatan.update();
      }

      if (xPixel < 880) {
        animasi = requestAnimationFrame(updateSimulasi);
      } else {
        jalan = false;
        cancelAnimationFrame(animasi);
      }
    }

    function resetSimulasi(clearAll = true) {
      cancelAnimationFrame(animasi);
      mobil.style.left = "0px";
      koordinat.style.left = "10px";
      koordinat.innerHTML = "(0 m, 0 s)";
      jalan = false;
      waktu = 0;
      posisi = 0;
      kecepatan = 0;
      if (clearAll) {
        while (tabel.rows.length > 1) tabel.deleteRow(1);
        chartPosisi.data.labels = [];
        chartPosisi.data.datasets[0].data = [];
        chartKecepatan.data.labels = [];
        chartKecepatan.data.datasets[0].data = [];
        chartPosisi.update();
        chartKecepatan.update();
      }
    }
  </script>
</body>
</html>
